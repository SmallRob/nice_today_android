/* ============================================
   WebView 全局修复样式 v3
   目标：
   1. 解决所有页面（除 Dashboard）在窄屏下的自动等比例缩放变形。
   2. 修复 Grid 布局因 minmax(300px, 1fr) 导致的强制换行。
   3. 锁定字体大小，防止 clamp() 在不同 WebView 容器中产生抖动。
   ============================================ */

/* 1. 禁用全局自动缩放，锁定视口 */
:root {
    -webkit-text-size-adjust: 100% !important;
    text-size-adjust: 100% !important;
}

/* 2. 覆盖 webview-optimization.css 中不稳定的 Grid 默认值 */
/* 修复 repeat(auto-fit, minmax(min(300px, 100%), 1fr)) 导致的换行错乱 */
:not(.dashboard-page-wrapper) .grid {
    display: grid !important;
    grid-template-columns: repeat(auto-fit, minmax(0, 1fr)) !important;
    width: 100% !important;
    max-width: 100% !important;
}

/* 3. 针对 Tailwind 常用列数的强制修复 */
@media (max-width: 768px) {
    :not(.dashboard-page-wrapper) .grid-cols-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    }

    :not(.dashboard-page-wrapper) .grid-cols-3 {
        grid-template-columns: repeat(3, minmax(0, 1fr)) !important;
    }

    :not(.dashboard-page-wrapper) .grid-cols-4 {
        grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    }

    :not(.dashboard-page-wrapper) .grid-cols-5 {
        grid-template-columns: repeat(3, minmax(0, 1fr)) !important;
    }
}

/* 4. 锁定字体，防止 clamp() 缩放变形 (排除 Dashboard) */
:not(.dashboard-page-wrapper) .text-xs {
    font-size: 12px !important;
    line-height: 16px !important;
}

:not(.dashboard-page-wrapper) .text-sm {
    font-size: 14px !important;
    line-height: 20px !important;
}

:not(.dashboard-page-wrapper) .text-base {
    font-size: 16px !important;
    line-height: 24px !important;
}

:not(.dashboard-page-wrapper) .text-lg {
    font-size: 18px !important;
    line-height: 28px !important;
}

:not(.dashboard-page-wrapper) .text-xl {
    font-size: 20px !important;
    line-height: 28px !important;
}

:not(.dashboard-page-wrapper) .text-2xl {
    font-size: 24px !important;
    line-height: 32px !important;
}

:not(.dashboard-page-wrapper) .text-3xl {
    font-size: 30px !important;
    line-height: 36px !important;
}

/* 5. 间距锁定 */
:not(.dashboard-page-wrapper) .p-1 {
    padding: 4px !important;
}

:not(.dashboard-page-wrapper) .p-2 {
    padding: 8px !important;
}

:not(.dashboard-page-wrapper) .p-3 {
    padding: 12px !important;
}

:not(.dashboard-page-wrapper) .p-4 {
    padding: 16px !important;
}

:not(.dashboard-page-wrapper) .p-5 {
    padding: 20px !important;
}

:not(.dashboard-page-wrapper) .p-6 {
    padding: 24px !important;
}

/* 6. 解决等比例缩放导致的图片变形 */
img {
    max-width: 100% !important;
    height: auto !important;
    object-fit: contain !important;
}

/* 7. 特殊页面容器安全边距 */
.page-container,
.content-area {
    padding-left: 12px !important;
    padding-right: 12px !important;
    box-sizing: border-box !important;
    max-width: 100vw !important;
    overflow-x: hidden !important;
}

/* 8. 防止横向溢出的兜底方案 */
* {
    box-sizing: border-box;
}

/* 9. 锁定按钮和文本不换行 (针对小标签) */
.nav-tab,
.quick-action-label,
.btn-small {
    white-space: nowrap !important;
}

/* 10. Dashboard 隔离带 - 确保我们的 :not 选择器没覆盖到的地方也能通过嵌套优先级保护 */
.dashboard-page-wrapper * {
    /* 恢复 text-size-adjust 默认行为以利用其原有样式 */
    -webkit-text-size-adjust: auto;
}