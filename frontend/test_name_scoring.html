<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>姓名评分功能测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-card {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
        }
        .error {
            background: #ffebee;
            border-left-color: #f44336;
        }
        input {
            padding: 8px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            padding: 10px 20px;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #1976d2;
        }
    </style>
</head>
<body>
    <h1>姓名评分功能测试</h1>
    
    <div class="test-card">
        <h2>测试姓名拆分</h2>
        <input type="text" id="testName" placeholder="输入姓名（如：何秀奇）" value="何秀奇">
        <button onclick="testSplit()">测试拆分</button>
        <div id="splitResult"></div>
    </div>

    <div class="test-card">
        <h2>测试笔画获取</h2>
        <div id="strokeResult"></div>
    </div>

    <div class="test-card">
        <h2>测试五格计算</h2>
        <div id="gridResult"></div>
    </div>

    <script type="module">
        // 导入评分工具
        import { getCharStrokes, calculateFiveGrids, getMeaning } from './src/utils/nameScoring.js';

        window.getCharStrokes = getCharStrokes;
        window.calculateFiveGrids = calculateFiveGrids;
        window.getMeaning = getMeaning;

        window.testSplit = function() {
            const name = document.getElementById('testName').value;
            const resultDiv = document.getElementById('splitResult');
            const strokeDiv = document.getElementById('strokeResult');
            const gridDiv = document.getElementById('gridResult');

            if (!name) {
                resultDiv.innerHTML = '<div class="result error">请输入姓名</div>';
                return;
            }

            // 智能拆分
            let surname, firstName;
            if (name.length === 2) {
                surname = name[0];
                firstName = name[1];
            } else if (name.length === 3) {
                surname = name[0];
                firstName = name.substring(1);
            } else {
                surname = name.substring(0, 2);
                firstName = name.substring(2);
            }

            resultDiv.innerHTML = `
                <div class="result">
                    <p><strong>完整姓名：</strong>${name}</p>
                    <p><strong>姓：</strong>${surname}</p>
                    <p><strong>名：</strong>${firstName}</p>
                </div>
            `;

            // 获取笔画
            const surnameChars = surname.split('');
            const firstNameChars = firstName.split('');
            
            const surnameStrokes = surnameChars.map(c => getCharStrokes(c));
            const firstNameStrokes = firstNameChars.map(c => getCharStrokes(c));

            let strokeHTML = '<div class="result"><h3>笔画数：</h3>';
            strokeHTML += '<p><strong>姓氏笔画：</strong>';
            surnameChars.forEach((char, i) => {
                strokeHTML += `${char}(${surnameStrokes[i]}画) `;
            });
            strokeHTML += '</p><p><strong>名字笔画：</strong>';
            firstNameChars.forEach((char, i) => {
                strokeHTML += `${char}(${firstNameStrokes[i]}画) `;
            });
            strokeHTML += '</p></div>';
            strokeDiv.innerHTML = strokeHTML;

            // 计算五格
            const result = calculateFiveGrids(surname, firstName, surnameStrokes, firstNameStrokes);
            
            const tianMeaning = getMeaning(result.tian);
            const renMeaning = getMeaning(result.ren);
            const diMeaning = getMeaning(result.di);
            const waiMeaning = getMeaning(result.wai);
            const zongMeaning = getMeaning(result.zong);

            gridDiv.innerHTML = `
                <div class="result">
                    <h3>五格评分结果：</h3>
                    <p><strong>天格：</strong>${result.tian} - ${tianMeaning.type} - ${tianMeaning.desc}</p>
                    <p><strong>人格：</strong>${result.ren} - ${renMeaning.type} - ${renMeaning.desc}</p>
                    <p><strong>地格：</strong>${result.di} - ${diMeaning.type} - ${diMeaning.desc}</p>
                    <p><strong>外格：</strong>${result.wai} - ${waiMeaning.type} - ${waiMeaning.desc}</p>
                    <p><strong>总格：</strong>${result.zong} - ${zongMeaning.type} - ${zongMeaning.desc}</p>
                </div>
            `;
        };

        // 自动测试
        window.onload = () => {
            testSplit();
        };
    </script>
</body>
</html>
